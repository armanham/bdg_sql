CREATE DATABASE company;

CREATE TABLE Employee
(
    id         int primary key,
    name       varchar(20) not null,
    gender     varchar(6)  not null,
    position   varchar(20) not null,
    department varchar(20) not null,
    office     varchar(20) not null,
    age        int,
    start_date date,
    salary     money       not null
);

ALTER table employee
    ALTER column id add generated by default as identity;



CREATE table project
(
    id         int primary key generated by default as identity,
    name       varchar(20) not null,
    department varchar(20) not null,
    start_date date        not null,
    end_date   date        not null
);

ALTER table project
    ADD constraint project_start_end_date_check
        CHECK (start_date < end_date);

ALTER table project
    ADD constraint project_name_unique_ Unique (name);


SELECT *
from employee;

SELECT distinct department
from employee;

SELECT *
from employee
where position = 'Sales Manager';

SELECT *
from employee
where department = 'Marketing'
  and position = 'HR Director'
  and gender = 'Female';

SELECT *
from employee
where department = 'Sales'
order by salary desc;

Select *
from employee
where position = 'Software Eng'
   or position = 'Accountant';

SELECT *
from employee
where age between 30 and 40;

select department, max(salary) as max_salary
from employee
group by department;

select avg(salary::numeric::int)
from employee
where extract(year from start_date) > 2018;

select *
from project
where extract(year from start_date) > 2022
  and extract(year from end_date) < 2024;

select *
from project
where extract(year from start_date) between 2022 and 2022;